<template name="ntpEpiRatingMain">
  {{#if Template.subscriptionsReady}}
    {{#contentContainer}}
      {{> ntpEpiRatingTable}}
    {{/contentContainer}}
  {{else}}
    {{> isLoading}}
  {{/if }}
</template>


<template name="ntpEpiRatingTable">
  <h1>Rating summary: {{name}}
    <div class="btn-group pull-right">
      <button class="btn btn-default btn-xs dropdown-toggle" type="button" data-toggle="dropdown">
        Actions <span class="caret" title="Editing options"></span>
      </button>
      <ul class="dropdown-menu">
        <li>
          <a href="#" id='downloadExcel'>
            <i class="fa fa-fixed fa-file-excel-o"></i> Download Excel</a></li>
      </ul>
    </div>
  </h1>
  {{> tableTitle}}
  <table class="evidenceTable table table-compressed">
    <colgroup>
      <col width="20%">
      <col width="10%">
      <col width="10%">
      <col width="10%">
      <col width="10%">
      <col width="10%">
      <col width="10%">
      <col width="10%">
      <col width="10%">
    </colgroup>
    <thead>
      <tr class="ntpEpiRatingHeaders">
        <th>Reference</th>
        <th>Selection<br>bias</th>
        <th>Exposure<br>assessment</th>
        <th>Outcome<br>assessment</th>
        <th>Analysis</th>
        <th>Selective<br>reporting</th>
        <th>Sensitivity</th>
        <th>Confounding</th>
        <th>Overall</th>
      </tr>
    </thead>
    <tbody>
      {{#each results}}
        {{> ntpEpiRatingRow}}
      {{/each}}
    </tbody>
  </table>
</template>


<template name="ntpEpiRatingRow">
  <tr>
    <td>
      {{>printReference id=description.referenceID}}<br>
      {{organSiteCategory}}
    </td>
    <td class="ntpEpiRatingTd" data-toggle="popover"
        data-content="{{description.selectionBiasRationale}}">
      {{description.selectionBiasRating}}
    </td>
    <td class="ntpEpiRatingTd" data-toggle="popover"
        data-content="{{description.exposureAssessmentRationale}}">
      {{description.exposureAssessmentRating}}
    </td>
    <td class="ntpEpiRatingTd" data-toggle="popover"
        data-content="{{getOutcomeRatingRationale}}">
      {{confounder.getOutcomeRating}}
    </td>
    <td class="ntpEpiRatingTd" data-toggle="popover"
        data-content="{{description.analysisRationale}}">
      {{description.analysisRating}}
    </td>
    <td class="ntpEpiRatingTd" data-toggle="popover"
        data-content="{{description.selectiveReportingRationale}}">
      {{description.selectiveReportingRating}}
    </td>
    <td class="ntpEpiRatingTd" data-toggle="popover"
        data-content="{{description.sensitivityRatingRationale}}">
      {{description.sensitivityRating}}
    </td>
    <td class="ntpEpiRatingTd" data-toggle="popover"
        data-content="{{description.confounders.confoundingRatingRationale}}">
      {{confounder.confoundingRating}}
    </td>
    <td class="ntpEpiRatingTd" data-toggle="popover"
        data-content="N/A">
      {{description.overallUtility}}
    </td>
  </tr>
</template>
